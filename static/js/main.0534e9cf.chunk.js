(this.webpackJsonpweb_messager=this.webpackJsonpweb_messager||[]).push([[0],{13:function(e,a,t){e.exports={wrapper:"Me_wrapper__IM3pj",imageArea:"Me_imageArea__1l82X",noPic:"Me_noPic__sAjf4",uploadArea:"Me_uploadArea__2VNpm",controls:"Me_controls__3863O",fields:"Me_fields__2EJIo",fieldWrapper:"Me_fieldWrapper__1KJFx",inputContainer:"Me_inputContainer__bqy_E",fieldTitle:"Me_fieldTitle__1lTpT",uploadBackground:"Me_uploadBackground__2I976",fakeInput:"Me_fakeInput__1s-8e"}},15:function(e,a,t){e.exports={wrapper:"User_wrapper__1drih",link:"User_link__3FJo4",imageArea:"User_imageArea__2QnEL",texts:"User_texts__1ZAZc",noPic:"User_noPic__2TRkF",name:"User_name__HyUYF",bio:"User_bio__2_jdS",title:"User_title__uygZF",bioFull:"User_bioFull__3Kxe1",bioReg:"User_bioReg__3tNmz",controls:"User_controls__25AbI"}},16:function(e,a,t){e.exports={wrapper:"People_wrapper__-Wsj5",searchArea:"People_searchArea__3ikr-",link:"People_link__AfBws",itemWrapper:"People_itemWrapper__2lBie",imageArea:"People_imageArea__2QPa8",name:"People_name__159Tt",saved:"People_saved__2Vii0",itemsGrid:"People_itemsGrid__3bx5l"}},17:function(e,a,t){e.exports={wrapper:"Header_wrapper__3cdMp",title:"Header_title__3Exh4",name:"Header_name__-saLI",link:"Header_link__1Ok-A",backWrapper:"Header_backWrapper__1RCfw",icon:"Header_icon__2RCYY",backTitle:"Header_backTitle__1iwFV"}},18:function(e,a,t){e.exports={link:"Dialogs_link__2bExc",wrapper:"Dialogs_wrapper__3wLQE",itemWrapper:"Dialogs_itemWrapper__3KObr",imageArea:"Dialogs_imageArea__1dOA2",name:"Dialogs_name__1PyhO",unread:"Dialogs_unread__2cM5F"}},22:function(e,a,t){e.exports={wrapper:"Menu_wrapper__2C2NJ",icon:"Menu_icon__3FGZg",item:"Menu_item__XZHHC",selected:"Menu_selected__PJgrB"}},28:function(e,a,t){e.exports={wrapper:"Error404_wrapper__1KTC5",error:"Error404_error__13Fjb",link:"Error404_link__3VVDu"}},29:function(e,a,t){e.exports={contentGrid:"Content_contentGrid__2VCrq",content:"Content_content__qeVVB",header:"Content_header__2X44-",menu:"Content_menu__2exoi"}},30:function(e,a,t){e.exports={background:"NoPicture_background__2qu4L",letter:"NoPicture_letter__3lr0W",largeLetter:"NoPicture_largeLetter__2vTuD"}},31:function(e,a,t){e.exports={grid:"WithHeader_grid__Cjt0e",header:"WithHeader_header__3oxK4",body:"WithHeader_body__2D9Io"}},33:function(e,a,t){e.exports={wrapper:"Login_wrapper__3nSvO",fields:"Login_fields__aWA_h"}},37:function(e,a,t){e.exports={wrapper:"Loading_wrapper__3cGZG",spinner:"Loading_spinner__3RG7q"}},38:function(e,a,t){e.exports={hint:"Hint_hint__3cayL",icon:"Hint_icon__30739"}},49:function(e,a,t){e.exports={screen:"App_screen__pF4r7"}},5:function(e,a,t){e.exports={grid:"Chat_grid__35mNI",link:"Chat_link__17L_6",header:"Chat_header__1FZBV",icon:"Chat_icon__1d-aV",imageArea:"Chat_imageArea__18MWL",noPic:"Chat_noPic__29469",name:"Chat_name__2QafE",nameText:"Chat_nameText__CYU8M",footer:"Chat_footer__3b2o1",textarea:"Chat_textarea__2mywR",btnArea:"Chat_btnArea__1JqLI",messagesWrapper:"Chat_messagesWrapper__A3y3B",messageSpace:"Chat_messageSpace__3rEm2",sent:"Chat_sent__qiyD2",received:"Chat_received__2AL3a",bubble:"Chat_bubble__2x102",showMoreArea:"Chat_showMoreArea__o-bLi"}},50:function(e,a,t){e.exports={input:"Input_input__3FE-_"}},51:function(e,a,t){e.exports={heading1:"labels_heading1__2lUfk"}},52:function(e,a,t){e.exports={button:"Button_button__UiWK1"}},55:function(e,a,t){e.exports=t.p+"static/media/spinner.26f430b2.svg"},58:function(e,a,t){e.exports=t(92)},63:function(e,a,t){},92:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(25),l=t.n(c),o=(t(63),t(1)),i=t(49),s=t.n(i),u=t(3),m=t(33),d=t.n(m),_=t(50),f=t.n(_),h=function(e){return r.a.createElement("div",null,r.a.createElement("input",Object.assign({},e,{className:f.a.input})))},p=t(51),b=t.n(p),E=function(e){return r.a.createElement("h1",{className:b.a.heading1},e.text)},g=t(52),v=t.n(g),N=function(e){var a={borderColor:e.color,color:e.color,fontColor:e.color};return r.a.createElement("button",Object.assign({},e,{className:v.a.button,style:a}),e.label)},j=t(8),O=t(54),C=t.n(O).a.create({baseURL:"https://social-network.samuraijs.com/api/1.0/",withCredentials:!0,headers:{"API-KEY":"aaf01db3-6045-46f6-9014-316ea841444d"}}),k={fetchDialogs:function(){return C.get("/dialogs").then((function(e){return e.data}))},fetchMessages:function(e,a){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return C.get("/dialogs/".concat(e,"/messages?count=").concat(a,"&page=").concat(t)).then((function(e){return e.data}))},sendMessage:function(e,a){return C.post("/dialogs/".concat(e,"/messages"),{body:a}).then((function(e){return e.data}))}},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return C.get("users?page=".concat(e,"&count=").concat(a).concat(""!==t?"&term=".concat(t):"").concat(n?"&friend=true":"")).then((function(e){return e.data}))},A=function(e){return e&&C.get("follow/".concat(e)).then((function(e){return e.data}))},S=function(e){return e&&C.post("follow/".concat(e)).then((function(e){return e.data}))},x=function(e){return e&&C.delete("follow/".concat(e)).then((function(e){return e.data}))},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e&&C.get("profile/".concat(e)).then((function(e){return e.data}))},M=function(e){var a=new FormData;return a.append("image",e),C.put("profile/photo",a,{headers:{"Content-Type":"multipart/form-data"}})},I=function(e,a){var t={aboutMe:a,contacts:{facebook:null,github:null,instagram:null,mainLink:null,twitter:null,vk:null,website:null,youtube:null},lookingForAJob:!1,lookingForAJobDescription:"null",fullName:e};return C.put("profile",t).then((function(e){return e.data}))},T=function(){return C.get("auth/me").then((function(e){return e.data}))},P=function(e,a){return C.post("auth/login",{email:e,password:a}).then((function(e){return e.data}))},W=function(){return C.delete("auth/login").then((function(e){return e.data}))},H=t(7),L={authorized:!1,authId:null},U=function(e){return{type:"AUTH/SET_AUTH",authId:e.authId,authorized:e.authorized}},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"AUTH/SET_AUTH":return Object(H.a)(Object(H.a)({},e),{},{authorized:a.authorized,authId:a.authId});default:return e}},B=Object(j.b)((function(e){return{authorized:e.auth.authorized}}),{setAuth:U})((function(e){var a=Object(n.useState)(""),t=Object(o.a)(a,2),c=t[0],l=t[1],i=Object(n.useState)(""),s=Object(o.a)(i,2),m=s[0],_=s[1],f=Object(n.useState)(!1),p=Object(o.a)(f,2),b=p[0],g=p[1];return e.authorized?r.a.createElement(u.a,{to:"/dialogs"}):r.a.createElement("div",{className:d.a.wrapper},r.a.createElement("div",{className:d.a.fields},r.a.createElement(E,{text:"Sign In"}),r.a.createElement(h,{type:"email",placeholder:"Email",onChange:function(e){return l(e.target.value)},value:c}),r.a.createElement(h,{type:"password",placeholder:"Password",onChange:function(e){return _(e.target.value)},value:m}),r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement(N,{label:"Sign In",onClick:function(){g(!0),P(c,m).then((function(a){0===a.resultCode?(e.setAuth({authId:null,authorized:!0}),g(!1)):(alert("error: ".concat(a.messages)),g(!1))}))},disabled:b}))))})),F=t(28),D=t.n(F),G=t(4),R=function(){return r.a.createElement("div",{className:D.a.wrapper},r.a.createElement("div",{className:D.a.error},r.a.createElement(E,{text:"404"}),r.a.createElement(G.b,{className:D.a.link,to:"/dialogs"},"Go to home page")))},J=t(29),V=t.n(J),q=t(22),K=t.n(q),Y=function(e){return r.a.createElement("div",{className:K.a.item},r.a.createElement(G.b,{className:K.a.icon,to:e.path,activeClassName:"".concat(K.a.icon," ").concat(K.a.selected)},r.a.createElement("i",{className:e.icon})))},Z=function(){return r.a.createElement("div",{className:K.a.wrapper},r.a.createElement(Y,{path:"/users",icon:"fas fa-user-friends"}),r.a.createElement(Y,{path:"/dialogs",icon:"fas fa-comments"}),r.a.createElement(Y,{path:"/me",icon:"fas fa-cog"}))},Q=t(14),X=t(18),$=t.n(X),ee=t(37),ae=t.n(ee),te=t(55),ne=t.n(te),re=function(){return r.a.createElement("div",{className:ae.a.wrapper},r.a.createElement("img",{alt:"spinner",className:ae.a.spinner,src:ne.a}))},ce=t(38),le=t.n(ce),oe=function(e){return r.a.createElement("div",{className:le.a.hint},r.a.createElement("div",null,r.a.createElement("div",{className:le.a.icon},r.a.createElement("i",{className:e.icon})),r.a.createElement("div",null,r.a.createElement("h3",null,e.hint))))},ie=t(30),se=t.n(ie),ue=function(e){var a="".concat(e.name).toUpperCase()[0],t={backgroundColor:["#EC5858","#49E591","#F0B928","#88A7F7","#E25ABC"][e.id%5]};return r.a.createElement("div",{className:se.a.background,style:t},r.a.createElement("div",{className:e.large?se.a.largeLetter:se.a.letter},a))},me=t(31),de=t.n(me),_e=t(17),fe=t.n(_e),he=function(e){return e.backLink?r.a.createElement("div",{className:fe.a.backWrapper},r.a.createElement("div",{className:fe.a.icon},r.a.createElement(G.b,{className:fe.a.link,to:e.backLink}," ",r.a.createElement("i",{className:"fas fa-chevron-left"}))),r.a.createElement("div",{className:fe.a.name},r.a.createElement("h1",{className:fe.a.backTitle},e.title||"Header"))):r.a.createElement("div",{className:fe.a.wrapper},r.a.createElement("h1",{className:fe.a.title},e.title||"Header"))},pe=function(e){return r.a.createElement("div",{className:de.a.grid},r.a.createElement(he,Object.assign({className:de.a.header,title:e.headerTitle},e)),r.a.createElement("div",{className:de.a.body},e.children))},be=function(e){return r.a.createElement(G.b,{className:$.a.link,to:"/chat/".concat(e.id)},r.a.createElement("div",{className:$.a.itemWrapper},r.a.createElement("div",{className:$.a.imageArea},e.image?r.a.createElement("img",{src:e.image,alt:"Profile"}):r.a.createElement(ue,{id:e.id,name:e.name})),r.a.createElement("div",{className:$.a.name},e.name),r.a.createElement("div",{className:$.a.unread},e.unread&&r.a.createElement("i",{className:"fas fa-circle"}))))},Ee=function(){var e=Object(n.useState)(null),a=Object(o.a)(e,2),t=a[0],c=a[1],l=Object(n.useState)(!0),i=Object(o.a)(l,2),s=i[0],u=i[1];Object(n.useEffect)((function(){return m()}),[]);var m=function(){u(!0),k.fetchDialogs().then((function(e){u(!1),c(e)}))},d=t&&Object(Q.a)(t).map((function(e){return r.a.createElement(be,{key:e.id,id:e.id,name:e.userName,image:e.photos.small,unread:e.hasNewMessages})}));return s?r.a.createElement(re,null):r.a.createElement(pe,{headerTitle:"Dialogs"},t&&t.length>0?r.a.createElement("div",{className:$.a.wrapper},d):r.a.createElement(oe,{icon:"far fa-comment",hint:"Your dialogs will be here"}))},ge=t(16),ve=t.n(ge),Ne=function(e){return r.a.createElement(G.b,{className:ve.a.link,to:"/user/".concat(e.id)},r.a.createElement("div",{className:ve.a.itemWrapper},r.a.createElement("div",{className:ve.a.imageArea},r.a.createElement("div",{className:ve.a.imageArea},e.image?r.a.createElement("img",{src:e.image,alt:"Profile"}):r.a.createElement(ue,{id:e.id,name:e.name}))),r.a.createElement("div",{className:ve.a.name},e.name),r.a.createElement("div",{className:ve.a.saved},e.saved&&r.a.createElement("i",{className:"fas fa-star"}))))},je=function(){var e=Object(n.useState)(null),a=Object(o.a)(e,2),t=a[0],c=a[1],l=Object(n.useState)(!0),i=Object(o.a)(l,2),s=i[0],u=i[1],m=Object(n.useState)(!0),d=Object(o.a)(m,2),_=d[0],f=d[1],p=Object(n.useState)(1),b=Object(o.a)(p,2),E=b[0],g=b[1],v=Object(n.useState)(!0),j=Object(o.a)(v,2),O=j[0],C=j[1],k=Object(n.useState)(""),A=Object(o.a)(k,2),S=A[0],x=A[1],y=Object(n.useState)(0),M=Object(o.a)(y,2),I=M[0],T=M[1],P=t&&Object(Q.a)(t.items).map((function(e){return r.a.createElement(Ne,{key:e.id,name:e.name,id:e.id,image:e.photos.small,saved:e.followed})}));return Object(n.useEffect)((function(){f(!1),clearTimeout(I),T(setTimeout((function(){u(!0),w(1,10,S,""===S).then((function(e){c(e),u(!1)})),f(!0)}),1e3))}),[S]),r.a.createElement(pe,{headerTitle:"People"},r.a.createElement("div",{className:ve.a.wrapper},r.a.createElement("div",{className:ve.a.searchArea},r.a.createElement(h,{onChange:function(e){f(!1),x(e.target.value)},value:S,placeholder:"Search people..."})),s?r.a.createElement(re,null):0===t.totalCount?r.a.createElement(oe,{hint:""===S?_&&"Your Bookmarks will be here":_&&"No users found",icon:""===S?_&&"fas fa-user-friends":_&&"fas fa-search"}):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:ve.a.itemsGrid},P),t&&t.totalCount>10*E&&r.a.createElement("center",{style:{marginTop:"0.6rem",marginBottom:"0.6rem"}},r.a.createElement(N,{label:"Show more",onClick:function(){C(!1),w(E+1,10,S,""===S).then((function(e){var a=document.querySelector("#scroller").scrollTop;c(Object(H.a)(Object(H.a)({},t),{},{items:[].concat(Object(Q.a)(t.items),Object(Q.a)(e.items))})),C(!0),document.querySelector("#scroller").scrollTop=a})),g(E+1)},disabled:!O,color:"#bbb"})))))},Oe=t(20),Ce=t.n(Oe),ke=t(15),we=t.n(ke),Ae=t(13),Se=t.n(Ae),xe=function(e){return r.a.createElement("div",{className:Se.a.fieldWrapper},r.a.createElement("div",{className:Se.a.fieldTitle},e.title),r.a.createElement("div",{className:Se.a.inputContainer},r.a.createElement("input",{type:"text",onChange:e.onChange,value:e.value})))},ye=Object(j.b)((function(e){return{id:e.auth.authId}}),{setAuth:U})((function(e){var a=Object(n.useState)(null),t=Object(o.a)(a,2),c=t[0],l=t[1],i=Object(n.useState)(!0),s=Object(o.a)(i,2),u=s[0],m=s[1],d=Object(n.useState)(!1),_=Object(o.a)(d,2),f=_[0],h=_[1],p=Object(n.useState)(null),b=Object(o.a)(p,2),E=b[0],g=b[1];Object(n.useEffect)((function(){v(e.id)}),[]);var v=function(e){m(!0),y(e).then((function(e){l(e),g(e),m(!1)}))},j=function(a){m(!0),M(a).then((function(a){v(e.id),console.log(a)}))};return u?r.a.createElement(re,null):r.a.createElement(pe,{headerTitle:"Profile"},r.a.createElement("div",{className:Se.a.wrapper},r.a.createElement("div",{className:Se.a.imageArea},c&&c.photos.large?r.a.createElement("img",{src:c.photos.large,alt:"Profile"}):r.a.createElement("div",{className:Se.a.noPic},r.a.createElement(ue,{id:e.id,name:c.fullName,large:!0})),r.a.createElement("div",{className:Se.a.uploadArea},r.a.createElement("div",{className:Se.a.uploadBackground},r.a.createElement("label",{className:Se.a.fakeInput},r.a.createElement("i",{className:"fas fa-camera"}," "),r.a.createElement("input",{type:"file",accept:"image/jpeg,image/png",style:{visibility:"hidden"},onChange:function(e){e.target.files&&e.target.files.length&&j(e.target.files[0])}}))))),r.a.createElement("div",{className:Se.a.fields},r.a.createElement(xe,{title:"Your displayed name:",value:E.fullName,onChange:function(e){g(Object(H.a)(Object(H.a)({},E),{},{fullName:e.target.value}))}}),r.a.createElement(xe,{title:"Something about you:",value:E.aboutMe,onChange:function(e){g(Object(H.a)(Object(H.a)({},E),{},{aboutMe:e.target.value}))}})),r.a.createElement("div",{className:Se.a.controls},r.a.createElement(N,{color:"#4378a8",label:"Save",onClick:function(){I(E.fullName,E.aboutMe).then((function(a){v(e.id)}))},disabled:c.fullName===E.fullName&&c.aboutMe===E.aboutMe}),r.a.createElement(N,{color:"#f55353",label:"Log out",onClick:function(){h(!0),W().then((function(a){0===Number(a.resultCode)?(e.setAuth({authorized:!1,authId:null}),h(!1)):console.log(a)}))},disabled:f}))))})),Me=function(e){var a=Object(n.useState)(!1),t=Object(o.a)(a,2),c=t[0],l=t[1];return r.a.createElement("div",{className:we.a.bio},r.a.createElement("div",{className:we.a.title},"Bio:"),r.a.createElement("div",{onClick:function(){l(!c)},className:c?we.a.bioFull:we.a.bioReg},e.user&&e.user.aboutMe))},Ie=function(e){var a=e.id,t=Object(n.useState)(!0),c=Object(o.a)(t,2),l=c[0],i=c[1],s=Object(n.useState)(null),u=Object(o.a)(s,2),m=u[0],d=u[1],_=Object(n.useState)(!1),f=Object(o.a)(_,2),h=f[0],p=f[1],b=Object(n.useState)(!0),E=Object(o.a)(b,2),g=E[0],v=E[1];Object(n.useEffect)((function(){j(a)}),[a]),Object(n.useEffect)((function(){O(a)}),[a]);var j=function(e){i(!0),y(e).then((function(e){d(e),i(!1)}))},O=function(e){A(e).then((function(e){return p(e)}))};return l?r.a.createElement(re,null):r.a.createElement(pe,{headerTitle:m.fullName||"User",backLink:"/users"},r.a.createElement("div",{className:we.a.wrapper},r.a.createElement("div",{className:we.a.imageArea},m&&m.photos.large?r.a.createElement("img",{src:m.photos.large,alt:"Profile"}):r.a.createElement("div",{className:we.a.noPic},r.a.createElement(ue,{id:a,name:m.fullName,large:!0}))),r.a.createElement("div",{className:we.a.texts},m&&m.aboutMe&&r.a.createElement(Me,{user:m})),r.a.createElement("div",{className:we.a.controls},r.a.createElement(N,{color:"#4378a8",label:r.a.createElement(G.b,{className:we.a.link,to:"/chat/".concat(a)},"Send message")}),r.a.createElement(N,{color:"#4378a8",disabled:!g,onClick:function(){v(!1),h?x(a).then((function(e){0===e.resultCode&&p(!1),v(!0)})):S(a).then((function(e){0===e.resultCode&&p(!0),v(!0)}))},label:h?r.a.createElement("i",{className:"fas fa-star"}):r.a.createElement("i",{className:"far fa-star"})}))))},Te=Object(j.b)((function(e){return{authId:e.auth.authId}}),{})((function(e){var a=Object(u.g)().id;return Number(a)===e.authId?r.a.createElement(ye,null):r.a.createElement(Ie,{id:a})})),Pe=Object(j.b)((function(e){return{authorized:e.auth.authorized}}),{})((function(e){return e.authorized?r.a.createElement(Ce.a,null,r.a.createElement("div",{className:V.a.contentGrid},r.a.createElement("div",{className:V.a.content,id:"scroller"},r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/dialogs",render:function(){return r.a.createElement(Ee,null)}}),r.a.createElement(u.b,{path:"/users",render:function(){return r.a.createElement(je,null)}}),r.a.createElement(u.b,{path:"/me",render:function(){return r.a.createElement(ye,null)}}),r.a.createElement(u.b,{path:"/user/:id",render:function(){return r.a.createElement(Te,null)}}),r.a.createElement(u.b,{exact:!0,path:"/",render:function(){return r.a.createElement(u.a,{to:"/dialogs"})}}),r.a.createElement(u.b,{path:"*",render:function(){return r.a.createElement(u.a,{to:"/404"})}}))),r.a.createElement(Z,{className:V.a.menu}))):r.a.createElement(u.a,{to:"/login"})})),We=t(5),He=t.n(We),Le=t(57),Ue=function(e){return r.a.createElement("div",{className:He.a.messageSpace},r.a.createElement("div",{className:e.mine?He.a.sent:He.a.received},r.a.createElement("div",{className:He.a.bubble,dangerouslySetInnerHTML:{__html:e.text}})))},ze=function(e){return r.a.createElement("div",{className:He.a.header},r.a.createElement("div",{className:He.a.icon},r.a.createElement(G.b,{className:He.a.link,to:"/dialogs"}," ",r.a.createElement("i",{className:"fas fa-chevron-left"}))),r.a.createElement("div",{className:He.a.name},r.a.createElement("h1",{className:He.a.nameText},e.name||"Chat")),r.a.createElement("div",{className:He.a.imageArea},r.a.createElement(G.b,{to:"/user/".concat(e.id),style:{textDecoration:"none"}}," ",e.image?r.a.createElement("img",{src:e.image,alt:"Profile"}):r.a.createElement("div",{className:He.a.noPic},r.a.createElement(ue,{id:e.id,name:e.name})))))},Be=Object(j.b)((function(e){return{authorized:e.auth.authorized,authId:e.auth.authId}}),{})((function(e){var a=Object(u.g)().id,t=Object(n.useState)(null),c=Object(o.a)(t,2),l=c[0],i=c[1],s=Object(n.useState)(!0),m=Object(o.a)(s,2),d=m[0],_=m[1],f=Object(n.useState)(null),h=Object(o.a)(f,2),p=h[0],b=h[1],E=Object(n.useState)(""),g=Object(o.a)(E,2),v=g[0],j=g[1],O=Object(n.useState)(!1),C=Object(o.a)(O,2),w=C[0],A=C[1],S=Object(n.useState)(1),x=Object(o.a)(S,2),M=x[0],I=x[1],T=Object(n.useState)(!1),P=Object(o.a)(T,2),W=P[0],L=P[1],U=Object(n.useState)(0),z=Object(o.a)(U,2),B=z[0],F=z[1];Object(n.useEffect)((function(){D(),G(M)}),[]);var D=function(){_(!0),y(a).then((function(e){i({name:e&&e.fullName,photo:e.photos&&e.photos.small}),_(!1)}))},G=function(e){return _(!0),k.fetchMessages(a,20,e).then((function(e){b(e),_(!1);var a=document.getElementById("msg_scroll");a.scrollTop=a.scrollHeight}))},R=function(){""!==v&&k.sendMessage(a,v).then((function(e){b(Object(H.a)(Object(H.a)({},k),{},{items:[].concat(Object(Q.a)(p.items),[e.data.message]),totalCount:p.totalCount+1})),A(!1),j(""),F(B+1);var a=document.getElementById("msg_scroll");a.scrollTop=a.scrollHeight}))},J=p&&Object(Q.a)(p.items).map((function(a){return r.a.createElement(Ue,{key:a.id,mine:a.senderId===e.authId,text:a.body})}));return e.authorized?r.a.createElement(Ce.a,null,d?r.a.createElement("div",{className:He.a.messagesWrapper},r.a.createElement(re,null)):r.a.createElement("div",{className:He.a.grid},r.a.createElement(ze,{name:l&&l.name,image:l&&l.photo,id:a}),r.a.createElement("div",{className:He.a.messagesWrapper,id:"msg_scroll"},p&&p.items.length<p.totalCount&&r.a.createElement("div",{className:He.a.showMoreArea},r.a.createElement("center",null,r.a.createElement(N,{label:"Show more",onClick:function(){L(!0);var e=document.getElementById("msg_scroll"),t=e.scrollHeight;return k.fetchMessages(a,20,M+1+Math.floor(B/20)).then((function(a){b(Object(H.a)(Object(H.a)({},p),{},{items:[].concat(Object(Q.a)(a.items.slice(0,20-B%20)),Object(Q.a)(p.items))})),L(!1),I(M+1+Math.floor(B/20)),F(0);var n=e.scrollHeight;e.scrollTo(0,n-t)}))},disabled:W}))),J),r.a.createElement("div",{className:He.a.footer},r.a.createElement(Le.a,{className:He.a.textarea,placeholder:"Write a message...",minRows:1,maxRows:5,onChange:function(e){j("".concat(e.target.value))},onKeyPress:function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),R())},value:v}),r.a.createElement("div",{className:He.a.btnArea},r.a.createElement(N,{disabled:w,onClick:R,className:He.a.sendBtn,color:"#4378a8",label:r.a.createElement("i",{className:"fas fa-paper-plane"})}))))):r.a.createElement(u.a,{to:"/login"})})),Fe=Object(j.b)((function(e){return{authorized:e.auth.authorized}}),{setAuth:U})((function(e){var a=Object(n.useState)(!1),t=Object(o.a)(a,2),c=t[0],l=t[1];Object(n.useEffect)((function(){l(!1),Promise.all([i()]).then((function(){l(!0)}))}),[e.authorized]);var i=function(){return T().then((function(a){e.setAuth({authId:a.data.id,authorized:0===a.resultCode})}))};return c?r.a.createElement("div",null,r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/login",render:function(){return r.a.createElement(B,null)}}),r.a.createElement(u.b,{path:"/404",render:function(){return r.a.createElement(R,null)}}),r.a.createElement(u.b,{path:"/chat/:id",render:function(){return r.a.createElement(Be,null)}}),r.a.createElement(u.b,{path:"/",render:function(){return r.a.createElement(Pe,null)}}))):r.a.createElement(Ce.a,{className:s.a.screen},r.a.createElement(re,null))}));t(91),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var De=t(21),Ge=t(56),Re=Object(De.c)({auth:z}),Je=Object(De.d)(Re,Object(De.a)(Ge.a));window.store=Je;var Ve=Je;l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(G.a,{basename:"/web-messenger"},r.a.createElement(j.a,{store:Ve},r.a.createElement(Fe,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[58,1,2]]]);
//# sourceMappingURL=main.0534e9cf.chunk.js.map